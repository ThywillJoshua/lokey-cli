<div class="translations-page-container">
  <h1 appText [variant]="'title'">Keys & Values</h1>

  <div class="translations">
    <div class="translations__nav">
      <div class="translations__nav__left" [formGroup]="form">
        <input
          appTextInput
          [variant]="'sm'"
          [errorMessage]="keyOrValueNotFoundMessage()"
          type="text"
          [placeholder]="
            this.form.get('searchByKey')?.getRawValue()
              ? 'Search by: Key'
              : 'Search by: Value'
          "
          formControlName="searchInput"
        />

        <div class="translations__nav__left__by">
          <label appCheckbox class="translations__checkbox">
            <input type="checkbox" formControlName="searchByKey" />
            Key
          </label>
          <label appCheckbox class="translations__checkbox">
            <input type="checkbox" formControlName="searchByValue" />
            Value
          </label>
        </div>
      </div>

      <div class="translations__nav__right">
        <div class="translations__nav__right__sort-icon">
          @if (sort() === 'ASC') {
          <app-svg-icon
            (click)="sort.set('DESC')"
            [iconName]="'sort_a-z'"
          ></app-svg-icon>
          } @else if (sort() === 'DESC') {
          <app-svg-icon
            (click)="sort.set('ASC')"
            [iconName]="'sort_z-a'"
          ></app-svg-icon>

          }
        </div>
      </div>
    </div>

    <div class="translations__body">
      <table border="1" cellpadding="8" cellspacing="0">
        <thead class="thead">
          <tr class="tr">
            <th>
              <label appCheckbox class="translations__checkbox">
                <input
                  type="checkbox"
                  (change)="handleAllRowsCheckboxChange($event)"
                  [checked]="allRowsSelected()"
                />
              </label>
            </th>
            <th class="tr__title">
              <span appText [variant]="'title-sm'">KEY</span>
            </th>
            <th class="tr__title">
              <span appText [variant]="'title-sm'">VALUE</span>
            </th>
            <th class="hide">
              <div class="status">
                <app-label></app-label>
              </div>
            </th>
            <th>
              <div
                class="copy-icon"
                appNotificationLabel
                [notificationLabelPosition]="'centeredTopRight'"
                appPopoverLabel
                [popoverLabelText]="'Copy all as JSON'"
                [popoverLabelPosition]="'centeredTopRight'"
                (click)="copy(filteredData())"
              >
                <app-svg-icon [iconName]="'copy'"></app-svg-icon>
              </div>
            </th>
            <th class="hide">
              <div class="delete-icon">
                <svg
                  width="26"
                  height="24"
                  viewBox="0 0 26 24"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M11.5273 4.875V5.25H15.4388V4.875C15.4388 4.37772 15.2328 3.90081 14.866 3.54917C14.4992 3.19754 14.0018 3 13.4831 3C12.9644 3 12.4669 3.19754 12.1001 3.54917C11.7333 3.90081 11.5273 4.37772 11.5273 4.875ZM9.96265 5.25V4.875C9.96265 3.97989 10.3335 3.12145 10.9938 2.48851C11.654 1.85558 12.5494 1.5 13.4831 1.5C14.4167 1.5 15.3122 1.85558 15.9724 2.48851C16.6326 3.12145 17.0035 3.97989 17.0035 4.875V5.25H22.8708C23.0783 5.25 23.2773 5.32902 23.424 5.46967C23.5707 5.61032 23.6531 5.80109 23.6531 6C23.6531 6.19891 23.5707 6.38968 23.424 6.53033C23.2773 6.67098 23.0783 6.75 22.8708 6.75H21.6911L20.2109 19.176C20.1018 20.0911 19.6452 20.9358 18.9281 21.5488C18.211 22.1618 17.2836 22.5004 16.3229 22.5H10.6433C9.68247 22.5004 8.75512 22.1618 8.03804 21.5488C7.32096 20.9358 6.86431 20.0911 6.75517 19.176L5.27503 6.75H4.0953C3.88782 6.75 3.68883 6.67098 3.54212 6.53033C3.39541 6.38968 3.31299 6.19891 3.31299 6C3.31299 5.80109 3.39541 5.61032 3.54212 5.46967C3.68883 5.32902 3.88782 5.25 4.0953 5.25H9.96265ZM8.3104 19.005C8.37572 19.5539 8.64942 20.0606 9.07936 20.4286C9.50929 20.7965 10.0654 20.9999 10.6417 21H16.3236C16.8999 20.9999 17.456 20.7965 17.886 20.4286C18.3159 20.0606 18.5896 19.5539 18.6549 19.005L20.1171 6.75H6.84982L8.3104 19.005ZM11.1361 9.375C11.3436 9.375 11.5426 9.45402 11.6893 9.59467C11.836 9.73532 11.9184 9.92609 11.9184 10.125V17.625C11.9184 17.8239 11.836 18.0147 11.6893 18.1553C11.5426 18.296 11.3436 18.375 11.1361 18.375C10.9286 18.375 10.7297 18.296 10.5829 18.1553C10.4362 18.0147 10.3538 17.8239 10.3538 17.625V10.125C10.3538 9.92609 10.4362 9.73532 10.5829 9.59467C10.7297 9.45402 10.9286 9.375 11.1361 9.375ZM16.6123 10.125C16.6123 9.92609 16.5299 9.73532 16.3832 9.59467C16.2365 9.45402 16.0375 9.375 15.83 9.375C15.6225 9.375 15.4235 9.45402 15.2768 9.59467C15.1301 9.73532 15.0477 9.92609 15.0477 10.125V17.625C15.0477 17.8239 15.1301 18.0147 15.2768 18.1553C15.4235 18.296 15.6225 18.375 15.83 18.375C16.0375 18.375 16.2365 18.296 16.3832 18.1553C16.5299 18.0147 16.6123 17.8239 16.6123 17.625V10.125Z"
                    fill="#8E8E99"
                  />
                </svg>
              </div>
            </th>
          </tr>
        </thead>
        @for (item of ( (paginatedData() | convertObjectIntoArray)); track
        item.key; let idx = $index) {
        <tbody class="tbody">
          <tr>
            <label appCheckbox class="translations__checkbox">
              <input
                type="checkbox"
                (change)="handleRowCheckboxChange($event, item.key)"
                [checked]="isSelected(item.key)"
              />
            </label>
          </tr>

          <tr class="tr">
            <td class="td">
              <div
                class="td__content"
                appPopoverLabel
                [popoverLabelText]="item.key"
                [popoverLabelTextEl]="valueTextElement"
              >
                <div
                  class="copy-icon"
                  appNotificationLabel
                  (click)="copy(item.key)"
                >
                  <app-svg-icon [iconName]="'copy'"></app-svg-icon>
                </div>
                <div class="td__content__text" #valueTextElement>
                  <a
                    [routerLink]="[
                      '/' + PATHS.TRANSLATIONS,
                      ENCODE_URI_COMPONENT(item.key)
                    ]"
                  >
                    <span appText>{{ item.key }}</span>
                  </a>
                </div>
              </div>
            </td>
            <td class="td">
              <div
                class="td__content"
                appPopoverLabel
                [popoverLabelText]="item.value"
                [popoverLabelTextEl]="keyTextElement"
              >
                <div
                  class="copy-icon"
                  appNotificationLabel
                  (click)="copy(item.value)"
                >
                  <app-svg-icon [iconName]="'copy'"></app-svg-icon>
                </div>

                <div class="td__content__text">
                  <a
                    [routerLink]="[
                      '/' + PATHS.TRANSLATIONS,
                      ENCODE_URI_COMPONENT(item.key)
                    ]"
                  >
                    <span class="td__content__text" appText #keyTextElement>
                      {{ item.value }}</span
                    >
                  </a>
                </div>
              </div>
            </td>
          </tr>
          <tr>
            <div class="status">
              <app-label></app-label>
            </div>
          </tr>
          <tr>
            <div
              class="copy-icon"
              appNotificationLabel
              [notificationLabelPosition]="'centeredTopRight'"
              (click)="copy(item.key + ': ' + item.value)"
              appPopoverLabel
              [popoverLabelPosition]="'centeredTopRight'"
              [popoverLabelText]="item.key + ': ' + item.value"
            >
              <app-svg-icon [iconName]="'copy'"></app-svg-icon>
            </div>
          </tr>
          <tr>
            <div class="trash-icon">
              <app-svg-icon [iconName]="'trash'"></app-svg-icon>
            </div>
          </tr>
        </tbody>
        }
      </table>
    </div>

    <div class="translations__footer">
      <div class="translations__footer__paginator">
        <button (click)="goToPreviousPage()" [class.hide]="pageNumber() === 1">
          <app-svg-icon [iconName]="'arrow-solid-left'"></app-svg-icon>
        </button>

        <div></div>

        <button (click)="goToNextPage()" [class.hide]="!hasMorePages()">
          <app-svg-icon [iconName]="'arrow-solid-right'"></app-svg-icon>
        </button>
      </div>
    </div>
  </div>
</div>
